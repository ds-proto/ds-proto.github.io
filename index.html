<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>US Foreign Expenditure Analysis</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="images/favicon.png">

  <!-- Scripts
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <script src="lib/d3.min.js"></script>
  <script src="lib/dimple.v2.1.6.min.js"></script>
  <script src="lib/topojson.min.js"></script>
  <script src="lib/datamaps.world.min.js"></script>

  <script>
   var appstate = {
       predictor: '2003-2012 Agriculture',
       predictors: [
           '2003-2012 Agriculture',
           '2003-2012 Commodity Assistance',
           '2003-2012 Economic Growth',
           '2003-2012 Education',
           '2003-2012 Governance',
           '2003-2012 Health and Population',
           '2003-2012 Humanitarian',
           '2003-2012 Infrastructure',
           '2003-2012 Other'
       ],

       response: '2000-2013 Life Expectancy Increase',
       responses: [
           '2000-2013 Life Expectancy Increase',
           '2000-2013 Education Index Increase',
           '2000-2013 Mean Years of Schooling Increase',
           '2000-2013 Income Index Increase',
           '2000-2013 GNI per Capita Increase',
           '2000-2013 HDI Increase'
       ],
       width: 1200,
       height: 800,
       data: 'data/merged_aid.csv'
   };

   var width = appstate.width;
   var height = appstate.height;


   function createBubble(data,
                         div_id,
                         width, height,
                         x_dim, y_dim, z_dim,
                         extra_dim,
                         callback)
   {
       var div = document.getElementById(div_id);
       while (div.firstChild) {
           div.removeChild(div.firstChild);
       }
       var svg = dimple.newSvg('#' + div_id, width, height);
       d3.csv(data, function (data) {
           data = data.filter(function (record) {
               return record[x_dim] != "" && record[y_dim] != "" && record[z_dim] != "";
           });

           var myChart = new dimple.chart(svg, data);
           var x = myChart.addMeasureAxis("x", x_dim);
           var y = myChart.addMeasureAxis("y", y_dim);
           var z = myChart.addMeasureAxis("z", z_dim);
           myChart.addSeries(extra_dim, dimple.plot.bubble);
           myChart.addLegend(250, 10, 500, 50, "right");
           callback(myChart,x,y,z);
       });
   }

   function removeChildren(div) {
       while(div.firstChild) {
           div.removeChild(div.firstChild);
       }
   }

   function updateList(state, list_id, list_key, selected_key)
   {
       var list = document.getElementById(list_id);
       removeChildren(list);
       var list_data = state[list_key];
       list_data.forEach(function (list_entry) {
           var list_entry_class = selected_key;
           if (list_entry == state[selected_key]) {
               list_entry_class += ' selected';
           }
           var newEntry = document.createElement('LI');
           newEntry.className = list_entry_class;
           newEntry.onclick = function () {
               appstate[selected_key] = list_entry;
               update(appstate);
           };
           newEntry.innerHTML = list_entry;
           list.appendChild(newEntry);
       });
   }

   function update(state) {
       createBubble(state.data,
                    'main-chart',
                    state.width,
                    state.height,
                    state.predictor,
                    state.response,
                    "2014 Population",
                    ["Country","Region"],
                    function (myChart, x, y, z) {
                        myChart.draw();
                    });

       updateList(state, 'predictor-list', 'predictors', 'predictor')
       updateList(state, 'response-list', 'responses', 'response')
   }

  </script>
</head>
<body>
  <h4>Some sort of heat map</h4>
  <div style="width: 960px; height: 685px" id="basic">
  </div>
  <script type="text/javascript">
   var basic = new Datamap({
       element: document.getElementById("basic")
   });
  </script>
  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div class="container">
      <div style="margin-top: 10%">
        <h3>Analyzing Government Aid</h3>
        <p>
          Is there a connection between the US government's spending in foreign
          countries and human development? Lorem ipsum dolor sit amet,
          consectetur adipiscing elit. Donec vulputate ligula quis bibendum
          laoreet. Nam pellentesque neque lorem, sit amet rhoncus odio efficitur
          vel. Aenean venenatis fermentum purus a commodo. Interdum et malesuada
          fames ac ante ipsum primis in faucibus. Donec tempus ante id nulla
          dignissim, sed hendrerit tellus pulvinar. Curabitur dictum hendrerit
          iaculis. Duis ex elit, tincidunt et scelerisque nec, rutrum vitae
          nulla.
        </p>
        <h4>About The Data</h4>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec
        vulputate ligula quis bibendum laoreet. Nam pellentesque neque lorem,
        sit amet rhoncus odio efficitur vel. Aenean venenatis fermentum purus a
        commodo. Interdum et malesuada fames ac ante ipsum primis in faucibus.
        Donec tempus ante id nulla dignissim, sed hendrerit tellus pulvinar.
        Curabitur dictum hendrerit iaculis. Duis ex elit, tincidunt et
        scelerisque nec, rutrum vitae nulla. </p>

        <h4>Where the US Spent Money on Foreign Aid in 2014</h4>

        <div id="chart2">
        </div>
        <script type="text/javascript">
         var svgPie = dimple.newSvg("#chart2", width, height);
         d3.csv("data/totals.csv", function (data) {
             var myChart = new dimple.chart(svgPie, data);
             myChart.addMeasureAxis("p", "Cost");
             myChart.addSeries("Category", dimple.plot.pie);
             myChart.addLegend(100, 20, 90, 300, "left");
             myChart.draw();
         });
        </script>

        <h4>Did the US expenditure on Foreign Aid Improve Human Development</h4>
        <div id="main-chart">
        </div>
        <div class="row">
          <div class="one-half column">
            <ul id="predictor-list">
            </ul>
          </div>
          <div class="one-half column">
            <ul id="response-list">
            </ul>
          </div>
        </div>

        <h4>The US Response to Foreign Education Need</h4>
        <div id="chart3">
        </div>
        <script type="text/javascript">
         createBubble("data/merged_aid.csv",
                      "chart3",
                      width,
                      height,
                      "2013 Mean Years of Schooling",
                      "Education",
                      "2014 Population",
                      ["Country","Region"],
                      function (myChart, x, y, z) {
                          myChart.draw();
                      });
        </script>

        <h4>The US Response to Foreign Health Need</h4>
        <div id="chart4">
        </div>
        <script type="text/javascript">
         createBubble("data/merged_aid.csv",
                      "chart4",
                      width,
                      height,
                      "2013 Life Expectancy",
                      "Health and Population",
                      "2014 Population",
                      ["Country","Region"],
                      function (myChart, x, y, z) {
                          x.overrideMin = 40;
                          x.overrideMax = 90;
                          myChart.draw();
                      });
        </script>


        <h4>The US Response to Foreign Economic Need</h4>
        <div id="chart5">
        </div>
        <script type="text/javascript">
         createBubble("data/merged_aid.csv",
                      "chart5",
                      width,
                      height,
                      "2013 GNI per Capita",
                      "Economic Growth",
                      "2014 Population",
                      ["Country","Region"],
                      function (myChart, x, y, z) {
                          myChart.draw();
                      });
        </script>


        <h4>US Foreign Aid costs from 2003 to 2013</h4>
        <div id="chart6">
        </div>
        <script type="text/javascript">
         var svgYearTotals = dimple.newSvg("#chart6", width, height);
         d3.csv("data/year_totals.csv", function (data) {
             var myChart = new dimple.chart(svgYearTotals, data);
             var x = myChart.addCategoryAxis("x", "Year");
             var y = myChart.addMeasureAxis("y", "Cost");
             var z = myChart.addSeries("Expenditure", dimple.plot.line);
             myChart.draw();
             y.titleShape.text("Money Spent on Expenditure ($)");
         });
        </script>

      </div>
  </div>

  <script type="text/javascript">
   update(appstate);
  </script>
<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
